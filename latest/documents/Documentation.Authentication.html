<!DOCTYPE html><html class="default" lang="en" data-base="../"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>Authentication | Magek Framework</title><meta name="description" content="Documentation for Magek Framework"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><link rel="stylesheet" href="../assets/custom.css"/><script defer src="../assets/main.js"></script><script defer src="../assets/custom.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="../index.html" class="title">Magek Framework</a><div id="tsd-toolbar-links"><a href="https://github.com/theam/magek">GitHub</a><a href="https://magek.ai">Website</a></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb" aria-label="Breadcrumb"><li><a href="Documentation.html">Documentation</a></li><li><a href="" aria-current="page">Authentication</a></li></ul></div><div class="tsd-panel tsd-typography"><h1 id="authentication" class="tsd-anchor-link">Authentication<a href="#authentication" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>Magek uses the OAuth 2.0 protocol to authenticate users. That means that it uses tokens to identify users and authorize them. These tokens are called <em>access tokens</em> and are issued by an <em>authentication provider</em>. The most common authentication provider is <a href="https://auth0.com/">Auth0</a>, but you can use any other provider that supports OAuth 2.0.</p>
<h2 id="configuring-the-authentication-provider" class="tsd-anchor-link">Configuring the authentication provider<a href="#configuring-the-authentication-provider" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The first step to configure authentication in Magek is to configure the authentication provider. The provider must support OAuth 2.0 and must be able to issue <em>access tokens</em>. In order to validate incoming tokens and make sure that user requests come from trustable origins, you need to provide one or more <code>TokenVerifier</code> instances at config time for each of your environments.</p>
<p>The <code>TokenVerifier</code> class is a simple interface that you can implement to define your own token verifiers. Magek provides a <code>JwksUriTokenVerifier</code> class that you can use to configure a JWT token verifier. The <code>JwksUriTokenVerifier</code> constructor accepts the following parameters:</p>
<ul>
<li><code>issuer</code>: The issuer of the tokens. This is a mandatory parameter. This is commonly found in the token payload under the <code>iss</code> key.</li>
<li><code>jwksUri</code>: The URL of the JSON Web Key Set (JWKS) that contains the public keys used to verify the tokens. This is a mandatory parameter. You can find more information about JWKS <a href="https://auth0.com/docs/jwks">here</a>.</li>
<li><code>rolesClaim</code>: The name of the claim that contains the user roles. This is an optional parameter. If not provided, the <code>roles</code> claim will be used. This is commonly found in the token payload under the <code>roles</code> key.</li>
</ul>
<p>Here is an example of how to configure a <code>JwksUriTokenVerifier</code>:</p>
<pre><code class="typescript"><br/><span class="hl-4">Magek</span><span class="hl-1">.</span><span class="hl-0">configure</span><span class="hl-1">(</span><span class="hl-2">&#39;production&#39;</span><span class="hl-1">, (</span><span class="hl-4">config</span><span class="hl-1">: </span><span class="hl-7">MagekConfig</span><span class="hl-1">): </span><span class="hl-7">void</span><span class="hl-1"> </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">config</span><span class="hl-1">.</span><span class="hl-4">appName</span><span class="hl-1"> = </span><span class="hl-2">&#39;app-name&#39;</span><br/><span class="hl-1">  </span><span class="hl-4">config</span><span class="hl-1">.</span><span class="hl-4">runtime</span><span class="hl-1"> = </span><span class="hl-4">ServerRuntime</span><br/><span class="hl-1">  </span><span class="hl-4">config</span><span class="hl-1">.</span><span class="hl-4">eventStoreAdapter</span><span class="hl-1"> = </span><span class="hl-4">eventStore</span><br/><span class="hl-1">  </span><span class="hl-4">config</span><span class="hl-1">.</span><span class="hl-4">tokenVerifiers</span><span class="hl-1"> = [</span><br/><span class="hl-1">      </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">JwksUriTokenVerifier</span><span class="hl-1">(</span><br/><span class="hl-1">        </span><span class="hl-2">&#39;https://my-auth0-tenant.auth0.com/&#39;</span><span class="hl-1">, </span><span class="hl-5">// Issuer</span><br/><span class="hl-1">        </span><span class="hl-2">&#39;https://my-auth0-tenant.auth0.com/.well-known/jwks.json&#39;</span><span class="hl-1">, </span><span class="hl-5">// JWKS URL</span><br/><span class="hl-1">        </span><span class="hl-2">&#39;role&#39;</span><span class="hl-1"> </span><span class="hl-5">// Roles claim</span><br/><span class="hl-1">      ),</span><br/><span class="hl-1">    ])</span><br/><span class="hl-1">})</span>
</code><button type="button">Copy</button></pre>

<p>One common way to validate JWT tokens is by using a issuer-provided well-known URI on which you can find their <a href="https://datatracker.ietf.org/doc/html/rfc7517">JSON Web Key</a> sets (JWKS). If you use this method, you only need to provide the issuer's name, the JWKS URI and, if you're using role-based authentication, an optional <code>rolesClaim</code> option that sets the claim from which Magek will read the role names.</p>
<h3 id="jwks-uri-glossary" class="tsd-anchor-link">JWKS URI glossary<a href="#jwks-uri-glossary" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Here you can find a list of the most common authentication providers and their corresponding issuer, JWKS URI and roles claim:</p>
<p>The issuer and JWKS URI may change depending on the region you're using. Please check the provider's documentation to find the correct values for your use case.</p>
<p>The following list is not exhaustive and the information may be deprecated. If you want to add a new provider, or update an existing one, please open a PR to have this content up to date.</p>
<table>
<thead>
<tr>
<th>Provider</th>
<th>Issuer</th>
<th>JWKS URI</th>
</tr>
</thead>
<tbody>
<tr>
<td>Auth0</td>
<td><code>https://&lt;your-tenant&gt;.auth0.com/</code></td>
<td><code>https://&lt;your-tenant&gt;.auth0.com/.well-known/jwks.json</code></td>
</tr>
<tr>
<td>Okta</td>
<td><code>https://&lt;your-tenant&gt;.okta.com/oauth2/default</code></td>
<td><code>https://&lt;your-tenant&gt;.okta.com/oauth2/default/v1/keys</code></td>
</tr>
<tr>
<td>Google</td>
<td><code>https://accounts.google.com</code></td>
<td><code>https://www.googleapis.com/oauth2/v3/certs</code></td>
</tr>
<tr>
<td>Firebase</td>
<td><code>https://accounts.google.com</code></td>
<td><code>https://www.googleapis.com/oauth2/v3/certs</code></td>
</tr>
</tbody>
</table>
<h2 id="public-key-based-authentication" class="tsd-anchor-link">Public key based authentication<a href="#public-key-based-authentication" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>PublicKeyTokenVerifier</code> class uses the public key of the issuer to verify the token signature. This means that the issuer must provide a JWKS URI that can be used to verify the token signature. This is the most common way to verify tokens, but it's not the only one. If you want to use a different method, you can implement your own <code>TokenVerifier</code> class.</p>
<p>This is useful when the token issuer doesn't provide a JWKS URI, when you're implementing your own authentication mechanism or you're issuing self-signed tokens.</p>
<pre><code class="typescript"><br/><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">publicKeyResolver</span><span class="hl-1">(): </span><span class="hl-7">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">string</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">  </span><span class="hl-5">// Your implementation here</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">Magek</span><span class="hl-1">.</span><span class="hl-0">configure</span><span class="hl-1">(</span><span class="hl-2">&#39;production&#39;</span><span class="hl-1">, (</span><span class="hl-4">config</span><span class="hl-1">: </span><span class="hl-7">MagekConfig</span><span class="hl-1">): </span><span class="hl-7">void</span><span class="hl-1"> </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">config</span><span class="hl-1">.</span><span class="hl-4">appName</span><span class="hl-1"> = </span><span class="hl-2">&#39;app-name&#39;</span><br/><span class="hl-1">  </span><span class="hl-4">config</span><span class="hl-1">.</span><span class="hl-4">runtime</span><span class="hl-1"> = </span><span class="hl-4">ServerRuntime</span><br/><span class="hl-1">  </span><span class="hl-4">config</span><span class="hl-1">.</span><span class="hl-4">eventStoreAdapter</span><span class="hl-1"> = </span><span class="hl-4">eventStore</span><br/><span class="hl-1">  </span><span class="hl-4">config</span><span class="hl-1">.</span><span class="hl-4">tokenVerifiers</span><span class="hl-1"> = [</span><br/><span class="hl-1">    </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">PublicKeyTokenVerifier</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;issuer-name&#39;</span><span class="hl-1">, </span><span class="hl-5">// Issuer name</span><br/><span class="hl-1">      </span><span class="hl-0">publicKeyResolver</span><span class="hl-1">(), </span><span class="hl-5">// Promise that resolves to the public key string</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;custom:roles&#39;</span><span class="hl-1"> </span><span class="hl-5">// Name of the claim to read the roles from (if you&#39;re using role-based authorization)</span><br/><span class="hl-1">    ),</span><br/><span class="hl-1">  ]</span><br/><span class="hl-1">})</span>
</code><button type="button">Copy</button></pre>

<p>Notice that the <code>publicKeyResolver</code> is a promise that resolves to a string, so it can be used to load the public key from a remote location too (i.e. get it from your KMS).</p>
<p>If you need to handle private keys in production, consider using a KMS <a href="https://en.wikipedia.org/wiki/Key_management#Key_storage">(Key Management System)</a>. These systems often provide API endpoints that let you encrypt/sign your JWT tokens without exposing the private keys. The public keys can be set in a <code>PublicKeyTokenVerifier</code> to automate verification.</p>
<h2 id="custom-authentication" class="tsd-anchor-link">Custom authentication<a href="#custom-authentication" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>If you want to implement your own authentication mechanism, you can implement your own <code>TokenVerifier</code> class. This class must implement the following interface:</p>
<pre><code class="typescript"><span class="hl-3">interface</span><span class="hl-1"> </span><span class="hl-7">TokenVerifier</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">/**</span><br/><span class="hl-5">   * Verify asd deserialize a stringified token with this token verifier.</span><br/><span class="hl-5">   * </span><span class="hl-3">@param</span><span class="hl-5"> </span><span class="hl-4">token</span><span class="hl-5"> The token to verify</span><br/><span class="hl-5">   */</span><br/><span class="hl-1">  </span><span class="hl-0">verify</span><span class="hl-1">(</span><span class="hl-4">token</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">): </span><span class="hl-7">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">DecodedToken</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-1">  </span><span class="hl-5">/**</span><br/><span class="hl-5">   * Build a valid `UserEnvelope` from a decoded token.</span><br/><span class="hl-5">   * </span><span class="hl-3">@param</span><span class="hl-5"> </span><span class="hl-4">decodedToken</span><span class="hl-5"> The decoded token</span><br/><span class="hl-5">   */</span><br/><span class="hl-1">  </span><span class="hl-0">toUserEnvelope</span><span class="hl-1">(</span><span class="hl-4">decodedToken</span><span class="hl-1">: </span><span class="hl-7">DecodedToken</span><span class="hl-1">): </span><span class="hl-7">UserEnvelope</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Here is an example of how to implement a custom <code>TokenVerifier</code>:</p>
<pre><code class="typescript"><br/><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-7">CustomTokenVerifier</span><span class="hl-1"> </span><span class="hl-3">implements</span><span class="hl-1"> </span><span class="hl-7">TokenVerifier</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">async</span><span class="hl-1"> </span><span class="hl-0">verify</span><span class="hl-1">(</span><span class="hl-4">token</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">): </span><span class="hl-7">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">DecodedToken</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">    </span><span class="hl-5">// Your custom token verification logic here</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">toUserEnvelope</span><span class="hl-1">(</span><span class="hl-4">decodedToken</span><span class="hl-1">: </span><span class="hl-7">DecodedToken</span><span class="hl-1">): </span><span class="hl-7">UserEnvelope</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// Your custom logic to build a UserEnvelope from a decoded token here</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">Magek</span><span class="hl-1">.</span><span class="hl-0">configure</span><span class="hl-1">(</span><span class="hl-2">&#39;production&#39;</span><span class="hl-1">, (</span><span class="hl-4">config</span><span class="hl-1">: </span><span class="hl-7">MagekConfig</span><span class="hl-1">): </span><span class="hl-7">void</span><span class="hl-1"> </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">config</span><span class="hl-1">.</span><span class="hl-4">appName</span><span class="hl-1"> = </span><span class="hl-2">&#39;app-name&#39;</span><br/><span class="hl-1">  </span><span class="hl-4">config</span><span class="hl-1">.</span><span class="hl-4">runtime</span><span class="hl-1"> = </span><span class="hl-4">ServerRuntime</span><br/><span class="hl-1">  </span><span class="hl-4">config</span><span class="hl-1">.</span><span class="hl-4">eventStoreAdapter</span><span class="hl-1"> = </span><span class="hl-4">eventStore</span><br/><span class="hl-1">  </span><span class="hl-4">config</span><span class="hl-1">.</span><span class="hl-4">tokenVerifiers</span><span class="hl-1"> = [</span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">CustomTokenVerifier</span><span class="hl-1">()]</span><br/><span class="hl-1">})</span>
</code><button type="button">Copy</button></pre>

<p>Some use cases for this could be to check that the token was generated specifically for your service by inspecting the <code>aud</code> claim, or check that the token has not been blacklisted or invalidated by your business logic (i.e. a user logs out before the token's expiration date and is included in an invalidated tokens list to make sure that an attacker that finds the token later can't use it to impersonate the legitimate owner).</p>
<h3 id="extend-existing-token-verifiers" class="tsd-anchor-link">Extend existing token verifiers<a href="#extend-existing-token-verifiers" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>If you only need to perform extra validations on top of one of the existing <code>TokenVerifier</code>s, you can extend one of the default implementations:</p>
<pre><code class="typescript"><span class="hl-6">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-7">CustomValidator</span><span class="hl-1"> </span><span class="hl-3">extends</span><span class="hl-1"> </span><span class="hl-7">PrivateKeyValidator</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">async</span><span class="hl-1"> </span><span class="hl-0">verify</span><span class="hl-1">(</span><span class="hl-4">token</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">): </span><span class="hl-7">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">UserEnvelope</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">    </span><span class="hl-5">// Call to the PrivateKeyValidator verify method to check the signature</span><br/><span class="hl-1">    </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-8">userEnvelope</span><span class="hl-1"> = </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-3">super</span><span class="hl-1">.</span><span class="hl-0">verify</span><span class="hl-1">(</span><span class="hl-4">token</span><span class="hl-1">)</span><br/><br/><span class="hl-1">    </span><span class="hl-5">// Do my extra validations here. Throwing an error will reject the token</span><br/><span class="hl-1">    </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-0">myExtraValidations</span><span class="hl-1">(</span><span class="hl-4">userEnvelope</span><span class="hl-1">.</span><span class="hl-4">claims</span><span class="hl-1">, </span><span class="hl-4">token</span><span class="hl-1">)</span><br/><br/><span class="hl-1">    </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-4">userEnvelope</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="advanced-authentication" class="tsd-anchor-link">Advanced authentication<a href="#advanced-authentication" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>If you need to do more advanced checks, you can implement the whole verification algorithm yourself. For example, if you're using non-standard or legacy tokens. Magek exposes for convenience many of the utility functions that it uses in the default <code>TokenVerifier</code> implementations:</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>getJwksClient</code></td>
<td>Initializes a jwksRSA client that can be used to get the public key of a JWKS URI using the <code>getKeyWithClient</code> function.</td>
</tr>
<tr>
<td><code>getKeyWithClient</code></td>
<td>Initializes a function that can be used to get the public key from a JWKS URI with the signature required by the <code>verifyJWT</code> function. You can create a client using the <code>getJwksClient</code> function.</td>
</tr>
<tr>
<td><code>verifyJWT</code></td>
<td>Verifies a JWT token using a key or key resolver function and returns a Magek UserEnvelope.</td>
</tr>
</tbody>
</table>
<pre><code class="typescript"><span class="hl-5">/**</span><br/><span class="hl-5"> * Initializes a jwksRSA client that can be used to get the public key of a JWKS URI using the</span><br/><span class="hl-5"> * `getKeyWithClient` function.</span><br/><span class="hl-5"> */</span><br/><span class="hl-6">export</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">getJwksClient</span><span class="hl-1">(</span><span class="hl-4">jwksUri</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  ...</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">/**</span><br/><span class="hl-5"> * Initializes a function that can be used to get the public key from a JWKS URI with the signature</span><br/><span class="hl-5"> * required by the `verifyJWT` function. You can create a client using the `getJwksClient` function.</span><br/><span class="hl-5"> */</span><br/><span class="hl-6">export</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">getKeyWithClient</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">client</span><span class="hl-1">: </span><span class="hl-7">jwksRSA</span><span class="hl-1">.</span><span class="hl-7">JwksClient</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">header</span><span class="hl-1">: </span><span class="hl-7">jwt</span><span class="hl-1">.</span><span class="hl-7">JwtHeader</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">callback</span><span class="hl-1">: </span><span class="hl-7">jwt</span><span class="hl-1">.</span><span class="hl-7">SigningKeyCallback</span><br/><span class="hl-1">): </span><span class="hl-7">void</span><span class="hl-1"> {</span><br/><span class="hl-1">  ...</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">/**</span><br/><span class="hl-5"> * Verifies a JWT token using a key or key resolver function and returns a Magek UserEnvelope.</span><br/><span class="hl-5"> */</span><br/><span class="hl-6">export</span><span class="hl-1"> </span><span class="hl-3">async</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">verifyJWT</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">token</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">issuer</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">key</span><span class="hl-1">: </span><span class="hl-7">jwt</span><span class="hl-1">.</span><span class="hl-7">Secret</span><span class="hl-1"> | </span><span class="hl-7">jwt</span><span class="hl-1">.</span><span class="hl-7">GetPublicKeyOrSecret</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">rolesClaim</span><span class="hl-1">?: </span><span class="hl-7">string</span><br/><span class="hl-1">): </span><span class="hl-7">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">UserEnvelope</span><span class="hl-1">&gt; {</span><br/><span class="hl-1"> ...</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#authentication"><span>Authentication</span></a><ul><li><a href="#configuring-the-authentication-provider"><span>Configuring the authentication provider</span></a></li><li><ul><li><a href="#jwks-uri-glossary"><span>JWKS <wbr/>URI glossary</span></a></li></ul></li><li><a href="#public-key-based-authentication"><span>Public key based authentication</span></a></li><li><a href="#custom-authentication"><span>Custom authentication</span></a></li><li><ul><li><a href="#extend-existing-token-verifiers"><span>Extend existing token verifiers</span></a></li><li><a href="#advanced-authentication"><span>Advanced authentication</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav id="tsd-sidebar-links" class="tsd-navigation"><a href="https://github.com/theam/magek" class="tsd-nav-link">GitHub</a><a href="https://magek.ai" class="tsd-nav-link">Website</a></nav><nav class="tsd-navigation"><a href="../modules.html">Magek Framework</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
